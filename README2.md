# NutriLeaf System Architecture & Technical Documentation

## üå± Overview

NutriLeaf is a comprehensive Moringa farming and health monitoring web application built with a modern tech stack. The system combines AI-powered plant health analysis, community forums, user management, and educational resources into a single platform.

## üèóÔ∏è System Architecture

### Frontend (React + TypeScript)
- **Framework**: React 18 with TypeScript
- **Deployment**: Vercel (https://nutrilea-f.vercel.app)
- **Styling**: CSS with custom components
- **State Management**: React Hooks (useState, useEffect)
- **HTTP Client**: Axios for API communication
- **Routing**: React Router DOM

### Backend (Flask + Python)
- **Framework**: Flask 2.3.3 with Python
- **Deployment**: Render (https://nutrileaf-10.onrender.com)
- **Server**: Gunicorn 20.1.0 (production)
- **Database**: SQLite (development) / PostgreSQL (production)
- **Authentication**: JWT tokens
- **File Uploads**: Multipart form data handling

## üì¶ Dependencies Explained

### Backend Requirements (requirements.txt)

#### Core Framework
- **Flask==2.3.3**: Main web framework for the backend API
- **gunicorn==20.1.0**: Production WSGI server for Flask
- **Werkzeug==2.3.7**: WSGI utility library (Flask dependency)
- **Flask-CORS==4.0.0**: Cross-Origin Resource Sharing for API access

#### Authentication & Security
- **PyJWT==2.8.0**: JSON Web Token implementation for user authentication
- **werkzeug.security**: Password hashing and verification (built into Werkzeug)

#### Database Support
- **psycopg2-binary**: PostgreSQL database adapter for production deployment
- **sqlite3**: Built-in SQLite database for development (no pip install needed)

#### AI/ML Libraries
- **tensorflow**: Deep learning framework for plant disease detection
- **numpy**: Numerical computing library for ML operations
- **opencv-python**: Computer vision library for image processing

#### Image Processing
- **Pillow**: Python Imaging Library for image manipulation and processing

### Frontend Dependencies (package.json)

#### Core React
- **react**: Main React library
- **react-dom**: React DOM renderer
- **react-router-dom**: Client-side routing
- **typescript**: Type-safe JavaScript

#### Development Tools
- **@types/react**: TypeScript definitions for React
- **@types/react-dom**: TypeScript definitions for React DOM
- **typescript compiler**: TypeScript compilation

#### HTTP & API
- **axios**: Promise-based HTTP client for API requests

#### UI & Styling
- Custom CSS with responsive design
- Component-based architecture

## üóÑÔ∏è Database Architecture

### Database Options
1. **SQLite** (Development): File-based database for local development
2. **PostgreSQL** (Production): Cloud-based database for persistent storage

### Database Tables

#### Users Table
```sql
- id (PRIMARY KEY)
- full_name (TEXT)
- email (UNIQUE TEXT)
- phone (TEXT)
- address (TEXT)
- password_hash (TEXT)
- profile_image (TEXT)
- created_at (TIMESTAMP)
```

#### Posts Table (Forum)
```sql
- id (PRIMARY KEY)
- user_id (FOREIGN KEY)
- title (TEXT)
- content (TEXT)
- attachments (TEXT - JSON)
- created_at (TIMESTAMP)
```

#### Comments Table (Forum)
```sql
- id (PRIMARY KEY)
- post_id (FOREIGN KEY)
- user_id (FOREIGN KEY)
- content (TEXT)
- created_at (TIMESTAMP)
```

#### Likes Table (Forum)
```sql
- id (PRIMARY KEY)
- post_id (FOREIGN KEY)
- comment_id (FOREIGN KEY)
- user_id (FOREIGN KEY)
- created_at (TIMESTAMP)
```

## üîê Authentication System

### JWT Token Authentication
- **Token Generation**: Created on login/registration
- **Token Verification**: Validates on protected routes
- **Token Expiration**: 30 days from creation
- **Secure Storage**: Tokens stored in localStorage

### Password Security
- **Hashing**: Werkzeug's generate_password_hash
- **Verification**: Werkzeug's check_password_hash
- **Salt**: Automatically generated by Werkzeug

## üìÅ File Structure

### Backend Structure
```
backend/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py          # Flask app initialization
‚îÇ   ‚îú‚îÄ‚îÄ routes/              # API route handlers
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.py          # User authentication
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ forum.py         # Forum functionality
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ image_analysis.py # AI image processing
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ chatbot.py       # AI chatbot
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...             # Other feature routes
‚îÇ   ‚îî‚îÄ‚îÄ static/uploads/       # File upload storage
‚îú‚îÄ‚îÄ config.py                # Configuration settings
‚îú‚îÄ‚îÄ requirements.txt         # Python dependencies
‚îî‚îÄ‚îÄ api/index.py            # API entry point
```

### Frontend Structure
```
frontend/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ components/          # Reusable UI components
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ HeaderNav.tsx   # Navigation header
‚îÇ   ‚îú‚îÄ‚îÄ screens/             # Main application screens
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LoginScreen.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RegisterScreen.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ForumScreen.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ProfileScreen.tsx
‚îÇ   ‚îú‚îÄ‚îÄ api/                # API communication
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ backend.ts      # Axios configuration
‚îÇ   ‚îî‚îÄ‚îÄ App.tsx            # Main app component
‚îú‚îÄ‚îÄ package.json            # Node.js dependencies
‚îî‚îÄ‚îÄ .env                   # Environment variables
```

## üîß Key Features Implementation

### 1. User Authentication
- **Registration**: Email validation, password hashing
- **Login**: JWT token generation
- **Profile Management**: Profile image uploads, user data updates
- **Session Management**: Token-based authentication

### 2. Forum System
- **Post Creation**: Rich text with file attachments
- **Comments**: Nested comment system
- **Likes**: Like posts and comments
- **File Uploads**: Image and video attachments
- **Real-time Updates**: Dynamic content loading

### 3. AI Image Analysis
- **Plant Disease Detection**: TensorFlow model integration
- **Image Processing**: OpenCV for preprocessing
- **Health Classification**: ML model predictions
- **Result Storage**: Analysis history tracking

### 4. File Management
- **Profile Images**: User avatar uploads
- **Forum Attachments**: Image/video file support
- **Secure Storage**: File validation and sanitization
- **URL Generation**: Static file serving

## üöÄ Deployment Architecture

### Frontend Deployment (Vercel)
- **Platform**: Vercel serverless platform
- **Build Process**: TypeScript compilation
- **Environment Variables**: API endpoints configuration
- **CDN**: Global content delivery network

### Backend Deployment (Render)
- **Platform**: Render cloud platform
- **Server**: Gunicorn WSGI server
- **Database**: PostgreSQL with persistent storage
- **File Storage**: Cloud-based file uploads
- **Environment Variables**: Database URLs and secrets

## üîå API Endpoints

### Authentication Endpoints
- `POST /api/auth/register` - User registration
- `POST /api/auth/login` - User login
- `GET /api/auth/verify` - Token verification
- `POST /api/auth/upload-profile-image` - Profile image upload

### Forum Endpoints
- `GET /api/forum/posts` - Get all forum posts
- `POST /api/forum/posts` - Create new post
- `GET /api/forum/posts/<id>/comments` - Get post comments
- `POST /api/forum/posts/<id>/comments` - Add comment
- `POST /api/forum/posts/<id>/like` - Like/unlike post

### AI Analysis Endpoints
- `POST /api/image-analysis/analyze` - Analyze plant image
- `POST /api/growth/classify` - Classify plant growth
- `POST /api/disease/detect` - Detect plant diseases

## üõ°Ô∏è Security Measures

### Authentication Security
- **Password Hashing**: Secure password storage
- **JWT Tokens**: Secure session management
- **Token Expiration**: Automatic session timeout
- **CORS Configuration**: Cross-origin request protection

### File Upload Security
- **File Type Validation**: Allowed file extensions only
- **File Size Limits**: Maximum file size restrictions
- **Secure Filenames**: Sanitized file naming
- **Path Traversal Prevention**: Secure file storage

### API Security
- **Input Validation**: Request data validation
- **SQL Injection Prevention**: Parameterized queries
- **Error Handling**: Secure error responses
- **Rate Limiting**: Request throttling (future implementation)

## üìä Performance Optimizations

### Frontend Optimizations
- **Code Splitting**: Lazy loading of components
- **Image Optimization**: Responsive image loading
- **Caching**: Browser caching strategies
- **Bundle Optimization**: Minified production builds

### Backend Optimizations
- **Database Indexing**: Optimized query performance
- **Connection Pooling**: Efficient database connections
- **Caching**: Response caching (future implementation)
- **Static File Serving**: Optimized file delivery

## üîß Development Workflow

### Local Development
1. **Backend**: `python api/index.py` on port 5000
2. **Frontend**: `npm start` on port 3000
3. **Database**: SQLite for local development
4. **Environment**: Local configuration files

### Production Deployment
1. **Backend**: Automatic deployment on Git push to Render
2. **Frontend**: Automatic deployment on Git push to Vercel
3. **Database**: PostgreSQL with persistent storage
4. **Environment**: Production environment variables

## üß™ Testing Strategy

### Frontend Testing
- **Component Testing**: React component testing
- **Integration Testing**: API integration testing
- **User Testing**: Manual user experience testing

### Backend Testing
- **Unit Testing**: Function-level testing
- **API Testing**: Endpoint testing
- **Database Testing**: Data integrity testing

## üìà Monitoring & Analytics

### Application Monitoring
- **Error Tracking**: Render error logs
- **Performance Metrics**: Response time monitoring
- **User Analytics**: Usage statistics (future)

### Database Monitoring
- **Query Performance**: Slow query identification
- **Connection Health**: Database connection monitoring
- **Storage Usage**: Database size tracking

## üîÆ Future Enhancements

### Planned Features
- **Real-time Chat**: WebSocket-based messaging
- **Advanced Analytics**: User behavior tracking
- **Mobile App**: React Native mobile application
- **API Rate Limiting**: Enhanced security features
- **Caching Layer**: Redis implementation
- **Email Notifications**: User notification system

### Technical Improvements
- **Microservices Architecture**: Service separation
- **Container Orchestration**: Kubernetes deployment
- **Advanced AI Models**: Enhanced plant analysis
- **Performance Monitoring**: APM integration

---

## üìû Support & Maintenance

### Regular Maintenance
- **Dependency Updates**: Regular package updates
- **Security Patches**: Vulnerability fixes
- **Performance Optimization**: Code improvements
- **Database Maintenance**: Regular backups and optimization

### Troubleshooting
- **Log Analysis**: Error log monitoring
- **Performance Debugging**: Performance issue resolution
- **User Support**: Bug fixes and feature requests

---

## üõ†Ô∏è Installation & Setup Guide

### Prerequisites

#### System Requirements
- **Operating System**: Windows 10+, macOS 10.15+, or Linux (Ubuntu 18.04+)
- **RAM**: Minimum 4GB, Recommended 8GB+
- **Storage**: Minimum 10GB free space
- **Network**: Internet connection for package downloads

#### Required Software & Versions

**1. Python (Backend)**
- **Version**: Python 3.9 - 3.12 (recommended: 3.11)
- **Download**: https://www.python.org/downloads/
- **Installation**: Add Python to PATH during installation
- **Verification**: `python --version` or `python3 --version`

**2. Node.js (Frontend)**
- **Version**: Node.js 16.x - 20.x (recommended: 18.x)
- **Download**: https://nodejs.org/
- **Package Manager**: npm (comes with Node.js) or yarn
- **Verification**: `node --version` and `npm --version`

**3. Git (Version Control)**
- **Version**: Git 2.25+
- **Download**: https://git-scm.com/
- **Verification**: `git --version`

**4. Code Editor (Recommended)**
- **VS Code**: https://code.visualstudio.com/
- **Extensions**: Python, TypeScript, React, GitLens

### Installation Steps

#### 1. Clone the Repository
```bash
git clone https://github.com/janella-yumang/NutrileaF.git
cd NutrileaF
```

#### 2. Backend Setup
```bash
# Navigate to backend directory
cd backend

# Create virtual environment
python -m venv venv

# Activate virtual environment
# Windows:
venv\Scripts\activate
# macOS/Linux:
source venv/bin/activate

# Install dependencies
pip install -r requirements.txt

# Create environment variables
# Create .env file with:
# SECRET_KEY=your-secret-key-here
# DATABASE_URI=sqlite:///data/database.db
```

#### 3. Frontend Setup
```bash
# Navigate to frontend directory
cd ../frontend

# Install dependencies
npm install

# Create environment variables
# Create .env file with:
# REACT_APP_API_URL=http://localhost:5000/api
```

#### 4. Start Development Servers

**Backend (Terminal 1)**
```bash
cd backend
# Activate virtual environment if not already active
venv\Scripts\activate  # Windows
# or
source venv/bin/activate  # macOS/Linux

# Start Flask development server
python api/index.py
# Server runs on http://localhost:5000
```

**Frontend (Terminal 2)**
```bash
cd frontend
# Start React development server
npm start
# App runs on http://localhost:3000
```

### Package Versions Summary

#### Backend Dependencies (requirements.txt)
```
Flask==2.3.3              # Web framework
gunicorn==20.1.0           # Production server
Flask-CORS==4.0.0          # Cross-origin requests
Werkzeug==2.3.7            # WSGI utilities
PyJWT==2.8.0               # JWT authentication
numpy                      # Numerical computing
tensorflow                 # Machine learning
opencv-python              # Computer vision
Pillow                     # Image processing
psycopg2-binary            # PostgreSQL adapter
```

#### Frontend Dependencies (package.json)
```
react^18.2.0               # React framework
react-dom^18.2.0           # React DOM
react-router-dom^6.8.0     # Routing
typescript^4.9.5           # Type safety
axios^1.3.4                # HTTP client
@types/react^18.0.28       # React types
@types/react-dom^18.0.11   # React DOM types
```

### Troubleshooting Installation

#### Common Issues

**Python Issues**
- Ensure Python 3.9+ is installed and in PATH
- Use `python3` instead of `python` if needed
- Virtual environment creation may require `python -m venv venv`

**Node.js Issues**
- Clear npm cache: `npm cache clean --force`
- Delete node_modules and package-lock.json, then `npm install`
- Use Node.js 18.x for best compatibility

**Backend Issues**
- Activate virtual environment before running
- Install dependencies in virtual environment only
- Check Python version compatibility with TensorFlow

**Frontend Issues**
- Ensure Node.js version is supported
- Check environment variables in .env file
- Verify API URL is correct and accessible

### Development Tools (Optional)

**Database Tools**
- **SQLite Browser**: https://sqlitebrowser.org/
- **PostgreSQL Client**: pgAdmin or DBeaver

**API Testing**
- **Postman**: https://www.postman.com/
- **Insomnia**: https://insomnia.rest/

**Version Control GUI**
- **GitHub Desktop**: https://desktop.github.com/
- **GitKraken**: https://www.gitkraken.com/

---

*This documentation provides a comprehensive overview of the NutriLeaf system architecture, technologies used, and implementation details. For specific code examples or API documentation, refer to the individual component files and API documentation.*



# 1. Clone repo
git clone https://github.com/janella-yumang/NutrileaF.git

# 2. Backend
cd backend
python -m venv venv
venv\Scripts\activate  # Windows
pip install -r requirements.txt
python api/index.py

# 3. Frontend (new terminal)
cd frontend
npm install
npm start
